---
title: 快速开始
date: 2021-08-26 17:13:48
permalink: /message-channel/quick_start
---

# 快速开始

::: center

欢迎来到 **消息通道** 的文档，让我们开始安装部署吧！:see_no_evil:

:::
## 环境需求

在开始前，请确保你拥有以下资源：

* 一台可以开放公网端口的服务器，至少拥有`500M`可用空间用于部署消息通道
* 一个属于自己的QQ号，用于转发消息。QQ号的等级越高，被风控的可能性越低
* 一台或多台CSGO游戏服务器，可以同时为消息通道的服务器

## 安装

### 安装docker和docker-compose

安装方法可以利用搜索引擎搜索，不过如果遇到问题，请以官方文档为准：

* [**docker 文档**](https://docs.docker.com/get-docker/)
* [**docker compose官方文档**](https://docs.docker.com/compose/install/)

::: details 举个栗子

以<Badge text="Ubuntu 20.04LTS" type="error" vertical="middle"/>操作系统为例使用`apt-get`安装，如果docker指令报错`connect: permission denied`，请以管理员权限运行。

```shell
# 卸载旧版本 docker
sudo apt-get remove docker docker-engine docker.io

# 更新 apt-get，安装依赖
sudo apt-get update
sudo apt-get install apt-transport-https ca-certificates curl software-properties-common
```

添加软件源密钥，国内建议使用国内源，官方源速度堪忧，国内和官方源选一个即可。

<code-group>
  <code-block title="国内源" active>

  ```shell
  curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
  ```
  </code-block>

  <code-block title="官方源">
  ```shell
  curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
  ```
  </code-block>
</code-group>

添加docker软件源

<code-group>
  <code-block title="国内源" active>
  ```shell
  sudo add-apt-repository \
    "deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
    $(lsb_release -cs) \
    stable"
  ```
  </code-block>

  <code-block title="官方源">
  ```shell
  sudo add-apt-repository \
    "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
    $(lsb_release -cs) \
    stable"
  ```
  </code-block>
</code-group>


安装docker
```shell
sudo apt-get update
sudo apt-get install docker-ce
```

验证docker安装是否成功

<code-group>
  <code-block title="命令" active>
  ```shell
  docker version
  ```
  </code-block>
  <code-block title="输出">
  ```shell

    Client: Docker Engine - Community
    Version:           20.10.8
    API version:       1.41
    Go version:        go1.16.6
    Git commit:        3967b7d
    Built:             Fri Jul 30 19:54:27 2021
    OS/Arch:           linux/amd64
    Context:           default
    Experimental:      true

    Server: Docker Engine - Community
        Engine:
    Version:          20.10.8
    API version:      1.41 (minimum version 1.12)
    Go version:       go1.16.6
    Git commit:       75249d8
    Built:            Fri Jul 30 19:52:33 2021
    OS/Arch:          linux/amd64
    Experimental:     false
    containerd:
    Version:          1.4.9
    GitCommit:        e25210fe30a0a703442421b0f60afac609f950a3
    runc:
    Version:          1.0.1
    GitCommit:        v1.0.1-0-g4144b63
    docker-init:
    Version:          0.19.0
    GitCommit:        de40ad0

    ```
  </code-block>

</code-group>

安装docker compose

```shell
sudo apt install docker-compose
```

验证docker compose安装是否成功

<code-group>
  <code-block title="命令" active>
```shell
docker-compose version
```
  </code-block>

  <code-block title="输出">
```shell
docker-compose version 1.25.0, build unknown
docker-py version: 4.1.0
CPython version: 3.8.10
OpenSSL version: OpenSSL 1.1.1f  31 Mar 2020
```
  </code-block>
</code-group>

:::

### docker镜像加速（可选）

由于本项目使用到的`go-cqhttp`和`redis`均为DockerHub中的镜像。

DockerHub官方源在国外，配置国内源可大幅提高镜像拉取速度。

相关参考文档：
* [**菜鸟教程-Docker镜像加速**](https://www.runoob.com/docker/docker-mirror-acceleration.html)
* [**阿里云-官方镜像加速**](https://help.aliyun.com/document_detail/60750.html)

## 获取 [消息通道]

消息通道通过以下两个途径获取：

1. 拉取仓库
    ```shell
    git clone https://github.com/hx-w/message-channel
    ```
    ::: warning
    直接拉取的源码可能包含未发布内容，稳定性没有经过充分测试。
    :::

2. 下载[**release**](https://github.com/hx-w/message-channel/releases/latest)（推荐）

## 修改配置

**一共有5部分内容需要配置**

以下只介绍必要的配置更改，更多内容见：[**详细配置**](/message-channel/config/)

### 1.通道配置

### 2.go-cqhttp配置

### 3.nonebot配置

### 4.redis配置

### 5.sourcemod配置

## 构建 [消息通道]

```shell
# 进入项目根目录
cd message-channel/

# 构建容器，如果报错`connect: permission denied`，请以管理员权限运行
# 第一次构建会拉取并构建容器组
docker-compose up -d
```

## 验证QQ登陆

TODO